<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>åŠ¨åŠ¨æ‰‹åšä¸€ä¸ªUserAgentåº“ - è¿›å‡»çš„Hunter</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="ä½ æ˜¯å¦æ›¾ä½¿ç”¨ç€ä¸€ä¸ªä¸¤ä¸ªæˆ–è€…ç›´æ¥ç™¾åº¦æ¥è°·æ­Œæ¥çš„å‡ ä¸ªUser-Agentæ¥ä½œä¸ºçˆ¬è™«çš„UAå¤´ï¼Œæˆ–æ˜¯ä»æµè§ˆå™¨è°ƒè¯•å·¥å…·æ‰’æ‹‰ä¸‹æ¥çš„æœ¬æœºUAå¤´ï¼Œç”šè‡³æ˜¯æœªä½¿ç”¨ã€‚ã€‚ä½œä¸ºä¸€ä¸ªçˆ¬è™«è„šæœ¬ï¼ŒåŸºæœ¬çš„ä¼ªè£…æ˜¯å¾ˆå¿…è¦çš„ã€‚">
	<meta name="generator" content="Hugo 0.53" />
	<meta property="og:title" content="åŠ¨åŠ¨æ‰‹åšä¸€ä¸ªUserAgentåº“" />
<meta property="og:description" content="ä½ æ˜¯å¦æ›¾ä½¿ç”¨ç€ä¸€ä¸ªä¸¤ä¸ªæˆ–è€…ç›´æ¥ç™¾åº¦æ¥è°·æ­Œæ¥çš„å‡ ä¸ªUser-Agentæ¥ä½œä¸ºçˆ¬è™«çš„UAå¤´ï¼Œæˆ–æ˜¯ä»æµè§ˆå™¨è°ƒè¯•å·¥å…·æ‰’æ‹‰ä¸‹æ¥çš„æœ¬æœºUAå¤´ï¼Œç”šè‡³æ˜¯æœªä½¿ç”¨ã€‚ã€‚ä½œä¸ºä¸€ä¸ªçˆ¬è™«è„šæœ¬ï¼ŒåŸºæœ¬çš„ä¼ªè£…æ˜¯å¾ˆå¿…è¦çš„ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://pyocean.com/post/2018_11_29_%E5%8A%A8%E5%8A%A8%E6%89%8B%E5%81%9A%E4%B8%80%E4%B8%AAuseragent%E5%BA%93/" /><meta property="article:published_time" content="2018-11-29T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2018-11-29T00:00:00&#43;00:00"/>

	<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="åŠ¨åŠ¨æ‰‹åšä¸€ä¸ªUserAgentåº“"/>
<meta name="twitter:description" content="ä½ æ˜¯å¦æ›¾ä½¿ç”¨ç€ä¸€ä¸ªä¸¤ä¸ªæˆ–è€…ç›´æ¥ç™¾åº¦æ¥è°·æ­Œæ¥çš„å‡ ä¸ªUser-Agentæ¥ä½œä¸ºçˆ¬è™«çš„UAå¤´ï¼Œæˆ–æ˜¯ä»æµè§ˆå™¨è°ƒè¯•å·¥å…·æ‰’æ‹‰ä¸‹æ¥çš„æœ¬æœºUAå¤´ï¼Œç”šè‡³æ˜¯æœªä½¿ç”¨ã€‚ã€‚ä½œä¸ºä¸€ä¸ªçˆ¬è™«è„šæœ¬ï¼ŒåŸºæœ¬çš„ä¼ªè£…æ˜¯å¾ˆå¿…è¦çš„ã€‚"/>

	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135738940-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="è¿›å‡»çš„Hunter" rel="home">
				<div class="logo__title">è¿›å‡»çš„Hunter</div>
				<div class="logo__tagline">Uneasy lies the head that wears the crown.</div>
			</a>
		</div>
		<a href="https://github.com/aoii103/every_day_cmd"><div style="
	height: 30px;
	display: inline-block;
	line-height:30px;
	padding:0 20px;
	color:rgb(73, 80, 87);
	font-size:13px;
	text-decoration:none;
	font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;" id="every_day_cmd" class="every_day_cmd" title="å­—å­—ç ç‘ï¼Œæ¯æ—¥ä¸€è®°ã€‚" ></div></a>
<div class="divider"></div>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
	axios.get('https://pyocean.com/every_day_cmd?os=osx,window,common').then(resp => {
		document.getElementById('every_day_cmd').innerHTML = `ğŸº ${resp.data.description}: <code  style="color: rgb(232, 62, 140);background:none;border:none;">${resp.data.code}</code>`
	})
</script>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">åŠ¨åŠ¨æ‰‹åšä¸€ä¸ªUserAgentåº“</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2018-11-29T00:00:00">November 29, 2018</time>
</div>
</div>
		</header>
		<figure class="post__thumbnail">
			<img src="/img/content_img/ua_demo/UAS.jpg" alt="åŠ¨åŠ¨æ‰‹åšä¸€ä¸ªUserAgentåº“">
		</figure>


<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ä»€ä¹ˆæ˜¯ua">ä»€ä¹ˆæ˜¯UA</a></li>
<li><a href="#å‘ç°ä¹‹æ—…">å‘ç°ä¹‹æ—…</a></li>
<li><a href="#å‘½ä»¤ä»£ç†proxychain4-ä»¥macä¸ºä¾‹">å‘½ä»¤ä»£ç†ProxyChain4ï¼ˆä»¥MACä¸ºä¾‹ï¼‰</a>
<ul>
<li>
<ul>
<li><a href="#è½¯ä»¶å®‰è£…">è½¯ä»¶å®‰è£…</a></li>
<li><a href="#è½¯ä»¶é…ç½®">è½¯ä»¶é…ç½®</a></li>
<li><a href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</a></li>
</ul></li>
</ul></li>
<li><a href="#æ•°æ®å­˜å‚¨">æ•°æ®å­˜å‚¨</a></li>
<li><a href="#æŸ¥è¯¢ä»£ç ">æŸ¥è¯¢ä»£ç </a></li>
<li><a href="#æºç é“¾æ¥">æºç é“¾æ¥</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ä½œä¸ºä¸€ä¸ªçˆ¬è™«è„šæœ¬ï¼ŒåŸºæœ¬çš„ä¼ªè£…æ˜¯å¾ˆå¿…è¦çš„ã€‚è€ŒUser-Agentå¤´è¿™ä¸ªçœ‹ä¼¼ä¸èµ·çœ¼çš„å…ƒç´ ï¼Œå´èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚</p>

<p>å½“ç„¶ï¼Œè¿™é‡Œè¿˜æ˜¯éœ€è¦ç§‘æ™®ä¸‹UAï¼Œæ˜¯ä½•ç‰©ã€‚</p>

<h2 id="ä»€ä¹ˆæ˜¯ua">ä»€ä¹ˆæ˜¯UA</h2>

<blockquote>
<p>Wikiï¼šåœ¨è®¡ç®—æœºç§‘å­¦ä¸­ï¼Œç”¨æˆ·ä»£ç†ï¼ˆè‹±è¯­ï¼šUser Agentï¼‰æŒ‡çš„æ˜¯ä»£è¡¨ç”¨æˆ·è¡Œä¸ºçš„è½¯ä»¶ä»£ç†ç¨‹åºæ‰€æä¾›çš„å¯¹è‡ªå·±çš„ä¸€ä¸ªæ ‡è¯†ç¬¦ã€‚</p>

<p>æˆ‘ï¼šç®€è€Œè¨€ä¹‹å°±æ˜¯è®¿é—®è€…çš„èº«ä»½è¯ã€‚</p>
</blockquote>

<h2 id="å‘ç°ä¹‹æ—…">å‘ç°ä¹‹æ—…</h2>

<p>é‚£ä¹ˆåœ¨å¸¸è§„çˆ¬è™«è„šæœ¬çš„ç¼–å†™ä¸­ï¼Œé€šè¿‡æ¯æ¬¡è¯·æ±‚è™šå‡çš„UAæ¥è£…é¥°æ¯æ¬¡è¯·æ±‚ï¼ŒåŒæ ·èƒ½è¾¾åˆ°ä¸€å®šçš„ä¼ªè£…ä½œç”¨,è¾ƒä¸ºç›´è§‚çš„ç†è§£å°±æ˜¯ï¼Œä¾‹å¦‚æˆ´äº†ä¸ªå£ç½©ã€‚</p>

<p><img src="/img/content_img/ua_demo/mengmian3.jpg" alt="mengmian3.jpg" /></p>

<blockquote>
<p>å¦‚æœå¯¹æ–¹åˆ¨æ ¹é—®åº•è¦ä½ æ‘˜ä¸‹å£ç½©æŸ¥ä½ IPçš„è¯ï¼Œé‚£è¿™ä¸ªå°±ä¸é€‚ç”¨äº†ï¼Œè¯·ç§»æ­¥æ–‡ç« [](/img/content_img/ua_demo/)</p>
</blockquote>

<p>åºŸè¯ä¸å¤šè¯´ï¼Œè¯´å¹²å°±å¹²ï¼Œé¦–å…ˆæˆ‘ä»¬æ‰“å¼€è°·æ­Œï¼ˆä¸è¦é—®æˆ‘æ˜¯æ€ä¹ˆæ‰“å¼€çš„ã€‚ã€‚ï¼‰å¹¶è¾“å…¥<code>user agent list</code>ï¼Œå›è½¦ã€‚</p>

<p><img src="/img/content_img/ua_demo/search.png" alt="search.png" /></p>

<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç»“æœä¸­è“æ¡†å†…æœ‰ç€ä»¤äººå…´å¥‹çš„ç»“æœï¼ŒUAçš„åŸºç¡€åˆ†ç±»ã€‚
è€Œçº¢æ¡†å†…ä¸ºæ­¤ç»“æœçš„æºURLåœ°å€ã€‚äºæ˜¯æˆ‘ä»¬è®¿é—®è¿™ä¸ªç«™ç‚¹ã€‚</p>

<p><img src="/img/content_img/ua_demo/mainpage.png" alt="mainpage" /></p>

<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ—è¡¨é€šè¿‡ç”¨é€”è¿›è¡Œäº†ä¸€å®šåˆ†ç±»ã€‚äºæ˜¯æˆ‘ä»¬è¿›è¡Œäº†ä¸€å®šçš„å¯¹æ¯”åˆ†æã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">https://developers.whatismybrowser.com/useragents/explore/software_name/chrome/
https://developers.whatismybrowser.com/useragents/explore/software_name/internet-explorer/
https://developers.whatismybrowser.com/useragents/explore/operating_system_name/windows/
https://developers.whatismybrowser.com/useragents/explore/operating_platform/nexus-5/</code></pre></div>
<p>ä¸éš¾çœ‹å‡ºï¼Œè¿™ä¸ªç«™ç‚¹æ ¹æ®å°¾éƒ¨çš„ä¸¤çº§ç›®å½•è¿›è¡Œäº†åˆ†ç±»</p>

<pre><code>\type1\
	\type2\
		\page
</code></pre>

<p>è¯´å¾—ç›´ç™½ä¸€ç‚¹ï¼Œè¿™æˆ–è®¸æ˜¯ <strong>ä¸‰ä¸ªå¾ªç¯</strong> å°±èƒ½æå®šçš„äº‹æƒ…ï¼Œå½“ç„¶pageå¾—æ ¹æ®æŠ“å–ç»“æœæ¥åˆ¤å®šã€‚</p>

<p><img src="/img/content_img/ua_demo/pagesearch.png" alt="" /></p>

<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦è·å–åˆ°å…¨éƒ¨çš„åˆ†ç±»é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯ä¸Š å›¾ä¸­ç¬¬ä¸€ä¸ªç®­å¤´æŒ‡å‘å…ƒç´ çš„ <code>href</code>å±æ€§ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡chromeè°ƒè¯•å·¥å…·ç›´æ¥é€‰å–åˆ°çº¢æ¡†å…ƒç´ cssè·¯å¾„å¹¶è¿›è¡Œå¯¹æ¯”æ€»ç»“å‡ºé€šç”¨è·¯å¾„</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"># listing-by-field-name &gt; li:nth-child(1) &gt; h2 &gt; a
# listing-by-field-name &gt; li:nth-child(2) &gt; h2 &gt; a

# listing-by-field-name &gt; li &gt; h2 &gt; a</code></pre></div>
<p>å¹¶ä¸”æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸‹çº§ç›®å½•ç›´æ¥ç»™å‡ºäº†äºŒçº§ç±»å‹åŠå…¶æ€»æ•°é‡ï¼Œå…·ä½“å–æ³•åŒä¸Šæ–‡ä¸å†èµ˜è¿°ã€‚</p>

<p><img src="/img/content_img/ua_demo/nums.png" alt="" /></p>

<p>æˆ‘ä»¬é€šè¿‡è®¿é—®ä»»æ„ç±»å‹çš„ä»»ä¸€ä¸€é¡µï¼Œå¹¶ç»Ÿè®¡å•é¡µæ•°é‡æ¥ç›´æ¥è®¡ç®—å‡ºæ€»é¡µæ•°ã€‚é‚£ä¹ˆæ€ä¹ˆå¿«é€Ÿè®¡ç®—å‘¢ã€‚è¿™é‡Œæˆ‘ä»¬æ¥è§‚å¯Ÿä¸‹æ•°æ®é›†æ‰€å¤„çš„domä½ç½®ã€‚</p>

<p><img src="/img/content_img/ua_demo/itemnums.png" alt="" /></p>

<p>å¯ä»¥çœ‹åˆ°å…¨æ–‡å°±ä¸€ä¸ª<code>tbody</code>æ ‡ç­¾ï¼Œå¹¶ä¸”æ¯é¡¹çš„ä¸€ä¸ª<code>td</code>æ ‡ç­¾å­˜åœ¨<code>useragent</code>è¿™æ ·ä¸€ä¸ªç±»å±æ€§ã€‚å¦‚æ­¤å°±å¥½åŠäº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¼–å†™jsè¯­å¥æ¥ç›´æ¥è¯»å–å•é¡µæ€»æ•°ã€‚</p>

<p><img src="/img/content_img/ua_demo/itemnums2.png" alt="" /></p>

<p>äºæ˜¯æ€»é¡µæ•°å°±ä¸º<code>math.ceil(nums/50)</code></p>

<p>å¦‚æ­¤ä¸€æ¥ï¼Œä¸€äºŒçº§ç›®å½•åç§°åŠæ€»é¡µæ•°éƒ½æ‰¾åˆ°äº†è§£å†³åŠæ³•ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹codingäº†ã€‚åœ¨ç¼–å†™è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°è¿™ä¸ªç«™ç‚¹ä¹Ÿæ˜¯å¯¹è®¿é—®é¢‘ç‡è¿›è¡Œäº†ä¸€å®šé™åˆ¶ï¼Œè€ŒTorä»£ç†å¯ä»¥å¾ˆå¥½åœ°ç»•è¿‡ã€‚å…·ä½“æ‰‹æ³•è¯¦è§ã€urlã€‘ã€‚</p>

<p>è€ƒè™‘åˆ°æˆ‘ä»¬ä½¿ç”¨çš„å¼‚æ­¥æ¨¡å—<code>asks</code>å¹¶æ²¡æœ‰<code>proxy</code>é…ç½®é¡¹ï¼Œäºæ˜¯ç»è¿‡ä¸€ç•ªæœå¯»ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†ä¸€ä¸ªå¾ˆå¥½çš„å‘½ä»¤è¡Œä»£ç†ï¼Œæ¥ä¸‹æ¥æˆ‘ç»™å¤§å®¶ä»‹ç»å®ƒåŠå…¶ä½¿ç”¨æ–¹æ³•ã€‚</p>

<h2 id="å‘½ä»¤ä»£ç†proxychain4-ä»¥macä¸ºä¾‹">å‘½ä»¤ä»£ç†ProxyChain4ï¼ˆä»¥MACä¸ºä¾‹ï¼‰</h2>

<blockquote>
<p>ä½¿ç”¨ç¯å¢ƒ<code>Linux, BSD, MAC</code>(winç”¨æˆ·çš„æ‚²å‰§)</p>
</blockquote>

<h4 id="è½¯ä»¶å®‰è£…">è½¯ä»¶å®‰è£…</h4>

<p>è¿™é‡Œæˆ‘ä»¬é€šè¿‡<code>brew</code>æ¥ç®¡ç†è½¯ä»¶åŒ…ï¼Œå…·ä½“å…³äº<code>brew</code>çš„å®‰è£…æ–¹å¼ä¸å†èµ˜è¿°ã€‚</p>

<p><code>brew install proxychains-ng</code></p>

<h4 id="è½¯ä»¶é…ç½®">è½¯ä»¶é…ç½®</h4>

<p><img src="/img/content_img/ua_demo/proxy.png" alt="" /></p>

<p>æˆ‘ä»¬é€šè¿‡<code>vim</code>ç¼–è¾‘é…ç½®æ–‡ä»¶<code>vi /usr/local/etc/proxychains.conf</code>ï¼Œæœç´¢<code>[ProxyList]</code>(ä¸€èˆ¬åœ¨åº•éƒ¨) åœ¨å…¶ä¸‹æ–¹åŠ ä¸Š <code>socks5  127.0.0.1 9150</code>(æ­¤ä¸ºTorä»£ç†èŠ‚ç‚¹)å¹¶ä¿å­˜ã€‚</p>

<h4 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h4>

<p>è¿™ä¸ªç¥å¥‡çš„æ’ä»¶å¯ä»¥é€šè¿‡<code>proxychains4 [ä½ è¦è¿è¡Œçš„å‘½ä»¤]</code> æ¥è®©ä»»ä½•å‘½ä»¤ç»è¿‡ä»£ç†</p>

<p><img src="/img/content_img/ua_demo/demo.png" alt="" /></p>

<p>å½“ç„¶å®ƒè¿˜èƒ½è¿™æ ·ï¼Œå¦‚ä¸‹æ˜¯ä¸€å¼ é²œæ˜çš„å¯¹æ¯”å›¾ã€‚</p>

<p><img src="/img/content_img/ua_demo/demo3.png" alt="" /></p>

<p>æƒ³å¿…ä¹Ÿæœ‰äººä¼šé—®ï¼Œæ˜¯å¦æœ¬åœ°åœ°å€ä¹Ÿä¼šèµ°ä»£ç†ï¼Œç­”æ¡ˆæ˜¯ï¼Œé»˜è®¤æ˜¯çš„ã€‚éœ€è¦é€šè¿‡ä¿®æ”¹é…ç½®æ‰èƒ½è·³è¿‡æœ¬åœ°åœ°å€ï¼Œæ‰¾åˆ°å¦‚ä¸‹é…ç½®å¹¶å»æ‰<strong>#</strong>å·å³å¯ã€‚</p>

<p><img src="/img/content_img/ua_demo/local.png" alt="" /></p>

<h2 id="æ•°æ®å­˜å‚¨">æ•°æ®å­˜å‚¨</h2>

<p>ä¸ºäº†å¿«é€Ÿæ„å»ºæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨sqliteï¼Œå¹¶é€šè¿‡æ¨¡å—<code>peewee</code>æ¥æ„å»ºORMï¼Œæ²¡æœ‰å®‰è£…çš„åŒå­¦å¯ä»¥é€šè¿‡<code>pip install peewee</code>æ¥å®‰è£…ã€‚</p>

<p>é¦–å…ˆæˆ‘ä»¬æ¥é…ç½®è¡¨å­—æ®µ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> peewee <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

db <span style="color:#f92672">=</span> SqliteDatabase(<span style="color:#e6db74">&#39;useragents.db&#39;</span>) <span style="color:#75715e"># åˆå§‹åŒ–æ•°æ®åº“</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UAS</span>(Model):
    uid <span style="color:#f92672">=</span> AutoField(primary_key<span style="color:#f92672">=</span>True, null<span style="color:#f92672">=</span>True) <span style="color:#75715e"># è‡ªå¢ID</span>
    useragent <span style="color:#f92672">=</span> TextField() <span style="color:#75715e"># UA</span>
    software <span style="color:#f92672">=</span> CharField(null<span style="color:#f92672">=</span>True) <span style="color:#75715e"># è½¯ä»¶ç±»å‹</span>
    engine <span style="color:#f92672">=</span> CharField(null<span style="color:#f92672">=</span>True) <span style="color:#75715e"># å¼•æ“</span>
    types <span style="color:#f92672">=</span> CharField(null<span style="color:#f92672">=</span>True) <span style="color:#75715e"># ç¡¬ä»¶ç±»å‹</span>
    popularity <span style="color:#f92672">=</span> CharField(null<span style="color:#f92672">=</span>True) <span style="color:#75715e"># é€šç”¨æ€§</span>

    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Meta</span>:
        database <span style="color:#f92672">=</span> db <span style="color:#75715e"># æŒ‡å®šæ•°æ®åº“</span>

db<span style="color:#f92672">.</span>connect() <span style="color:#75715e"># è¿æ¥æ•°æ®åº“</span>
db<span style="color:#f92672">.</span>create_tables([UAS]) <span style="color:#75715e"># åˆå§‹åŒ–åˆ›å»ºä¸å­˜åœ¨çš„åº“</span></code></pre></div>
<p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†è¡¨é…ç½®ï¼Œè€ƒè™‘åˆ°è„šæœ¬æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œç”¨åŒæ­¥ä»£ç ä¼šå¼•å‘æ€§èƒ½é—®é¢˜
ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨è¿è¡Œå®Œä¹‹åå†å°†æ•°æ®å­˜å‚¨ã€‚å¹¶ä¸”åœ¨ç¼–å†™ä¸­é‡åˆ°ä¸€ä¸ªé—®é¢˜ã€‚<code>peewee</code>çš„<code>insert__many</code>æ–¹æ³•å¹¶ä¸èƒ½ä¸€ä¸‹å­æ’å…¥è¾ƒå¤šçš„æ•°æ®ï¼Œæ‰€ä»¥å¾—å°†ç»“æœæ•°æ®åˆ†å—å­˜å‚¨ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">MakeChunk</span>(datas,length<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>):
    <span style="color:#66d9ef">for</span> item <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, math<span style="color:#f92672">.</span>ceil(len(datas)<span style="color:#f92672">/</span>length)):
        <span style="color:#66d9ef">yield</span> datas[item<span style="color:#f92672">*</span>length:(item<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>length]</code></pre></div>
<p>åœ¨å¦‚ä¸Šéƒ¨åˆ†å®Œæˆåï¼Œå¤§è‡´ä»£ç ä¹Ÿå·²å®Œæˆï¼Œè¿™é‡Œæˆªå–çˆ¬äº†ä¸€å®šæ•°é‡åä¸­æ–­çš„æˆªå›¾</p>

<p><img src="/img/content_img/ua_demo/uares.png" alt="" /></p>

<p>å¯ä»¥çœ‹åˆ°æ•°æ®å·²ç»æˆåŠŸå½•å…¥åˆ°äº†sqliteä¸­</p>

<p><img src="/img/content_img/ua_demo/uadb.png" alt="" /></p>

<p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ¶ä½œæ¨¡å—äº†ã€‚</p>

<h2 id="æŸ¥è¯¢ä»£ç ">æŸ¥è¯¢ä»£ç </h2>

<blockquote>
<p>åŸæœ¬è€ƒè™‘ä½¿ç”¨Djangoæ¥åšä½†é‚£æ ·å®ç”¨æ€§æ˜¯åœ¨å¤ªå·®äºæ˜¯å°±è§‰å¾—åšäº†ä¸ªé’ˆå¯¹ç‰¹å®šéœ€æ±‚å†…å®¹çš„è¿‡æ»¤æŸ¥è¯¢å¹¶éšæœºå–å€¼</p>
</blockquote>

<p>ä¸å¤šåºŸè¯ï¼Œç›´æ¥ä¸Šä»£ç ,è¿™é‡Œæˆ‘é€šè¿‡æœç´¢å…³é”®å†…å®¹<code>searchwords</code>å­—å…¸ä¼ å…¥å¸Œæœ›æŸ¥è¯¢çš„å‚æ•°ï¼Œå½“ç„¶è¿™é‡Œå¹¶æœªæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢ï¼Œè¿™æ˜¯æœ‰å¾…æ”¹è¿›çš„åœ°æ–¹ã€‚å¹¶ä»¥<code>methods</code>ä¸ºæ¡ä»¶ç»„åˆæ–¹æ³•ï¼ˆä¸ã€æˆ–ï¼‰è¿›è¡ŒæŸ¥è¯¢ã€‚</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">UserAgent</span>(searchwords, methods<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;and&#39;</span>):
    <span style="color:#e6db74">&#34;&#34;&#34;
</span><span style="color:#e6db74">       searchwords: 
</span><span style="color:#e6db74">       {
</span><span style="color:#e6db74">            &#34;key&#34;:[
</span><span style="color:#e6db74">                &#34;words1&#34;,
</span><span style="color:#e6db74">                &#34;words2&#34;
</span><span style="color:#e6db74">            ]
</span><span style="color:#e6db74">        }
</span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
    count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    resagent <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
    <span style="color:#66d9ef">if</span> methods <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> [<span style="color:#e6db74">&#39;and&#39;</span>, <span style="color:#e6db74">&#39;or&#39;</span>]:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;&#39;</span>
    methods <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&amp;&#39;</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> methods <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;or&#39;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#39;|&#39;</span>
    whereQuery <span style="color:#f92672">=</span> f<span style="color:#e6db74">&#39; {methods} &#39;</span><span style="color:#f92672">.</span>join([
        f<span style="color:#e6db74">&#39;(UAS.{key} &lt;&lt; {str(item)})&#39;</span> <span style="color:#66d9ef">for</span> key, item <span style="color:#f92672">in</span> searchwords<span style="color:#f92672">.</span>items()
    ])
    <span style="color:#66d9ef">try</span>:
        count <span style="color:#f92672">=</span> UAS<span style="color:#f92672">.</span>select()<span style="color:#f92672">.</span>where(eval(whereQuery))<span style="color:#f92672">.</span>order_by(fn<span style="color:#f92672">.</span>Random())<span style="color:#f92672">.</span>count()
        resagent <span style="color:#f92672">=</span> UAS<span style="color:#f92672">.</span>select()<span style="color:#f92672">.</span>where(eval(whereQuery))<span style="color:#f92672">.</span>order_by(
            fn<span style="color:#f92672">.</span>Random())<span style="color:#f92672">.</span>limit(<span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>useragent
    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
        <span style="color:#66d9ef">pass</span>
    <span style="color:#66d9ef">return</span> count, resagent
    </code></pre></div>
<p>ç»“æœå°†è¿”å›æ‰€èƒ½æŸ¥è¯¢åˆ°çš„<strong>æ•°æ®é‡</strong>åŠéšæœºä¸€ä¸ª<strong><code>UA</code></strong>ç»“æœå­—æ®µç»„æˆçš„å…ƒç¥–ï¼Œå½“ç„¶å¦‚æœæŸ¥è¯¢å‡ºé”™ä¹Ÿä¼šä»¥å‹å¥½çš„æ–¹å¼è¿”å›</p>

<p>åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹æ¡ˆä¾‹æµ‹è¯•ä¸€ä¸‹</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(UserAgent({
        <span style="color:#e6db74">&#34;software&#34;</span>: [
            <span style="color:#e6db74">&#39;Android Browser 4.0&#39;</span>
        ]
    }))</code></pre></div>
<p>å¯ä»¥çœ‹åˆ°ç»“æœå¦‚ä¸‹</p>

<p><img src="/img/content_img/ua_demo/fakedbres.png" alt="" /></p>

<p>ä¸è¿‡å¯èƒ½ä¼šæœ‰åŒå­¦é—®åˆ°ï¼Œæˆ‘è¦æ€ä¹ˆçŸ¥é“å…¶ä¸­åŒ…å«å“ªäº›ç§ç±»å‘¢ï¼Œè‡ªå·±å†™<code>group by</code>å—???</p>

<p>ç­”æ¡ˆæ˜¯å½“ç„¶ä¸ä¼šï¼Œè¿™é‡Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ª<code>UserAgentGroups(colname, limit=10)</code>æ–¹æ³•ä¾›å¼€å‘è€…æŸ¥é˜…,åªéœ€ä¼ å…¥ä¸€ä¸ª<strong>ç±»å‹å­—æ®µ<code>colname</code></strong>åŠ<strong>è¿”å›æœ€å¤§æ•°é‡<code>limit</code></strong>å³å¯ã€‚</p>

<p>ä¾‹å¦‚ï¼š<code>UserAgentGroups('engine', 5)</code>,è¿”å›ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºåˆ—è¡¨ã€‚</p>

<p><img src="/img/content_img/ua_demo/fakedbgroup.png" alt="" /></p>

<h2 id="æºç é“¾æ¥">æºç é“¾æ¥</h2>

<p><a href="https://github.com/aoii103/FakeUA">https://github.com/aoii103/FakeUA</a></p>
		</div>
		
<div class="post__tags tags clearfix">
	<svg class="icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/user-agent/" rel="tag">user-agent</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/python/" rel="tag">python</a></li>
	</ul>
</div>
	</article>
</main>
<h5>æ›´å¤šåŠæ—¶èµ„è®¯æ¬¢è¿å…³æ³¨ <code>è¿›å‡»çš„Hunter</code> </h5>
<img src="/img/qrcode.jpg" />


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/2018_10_24_%E4%B8%80%E4%B8%AAtor%E4%BB%A3%E7%90%86%E7%BB%95%E8%BF%87%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6%E7%9A%84%E5%85%B8%E5%9E%8B%E6%A1%88%E4%BE%8B/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ä¸€ä¸ªTorä»£ç†ç»•è¿‡è®¿é—®é™åˆ¶çš„å…¸å‹æ¡ˆä¾‹</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/2018_12_24_%E5%BF%AB%E9%80%9F%E5%AE%9E%E7%8E%B0%E6%9A%97%E7%BD%91%E4%BA%A4%E6%98%93%E7%9B%91%E6%8E%A7/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">å¿«é€Ÿå®ç°æš—ç½‘äº¤æ˜“ç›‘æ§</p></a>
	</div>
</nav>

<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-pyocean-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2021 s045pd.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>